Some bits of this code are modifications of Lagrange's ones
https://github.com/LeNPaul/Lagrange
